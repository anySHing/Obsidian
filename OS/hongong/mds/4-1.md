# ALU와 제어 장치

## ALU

- ALU가 받아들이는 정보

ALU는 레지스터를 통해 피연산자를 받아들이고, 제어 장치로부터 수행할 연산을 알려주는 제어 신호를 받아들인다.

- ALU가 내보내는 정보

연산을 수행한 결과는 특정 숫자나 문자가 될 수도 있고, 메모리 주소가 될 수도 있다. 그리고 이 결괏값은 바로 메모릭에 저장되지 않고 일시적으로 레지스터에 저장된다.

CPU가 메모리에 접근하는 속도는 레지스터에 접근하는 속도보다 훨씬 느리다.

ALU가 연산할 때 마다 결과를 메모리에 저장한다면 당연하게도 CPU는 메모리에 자주 접근하게 되고, 이는 CPU가 프로그램 실행 속도를 늦출 수 있으므로 레지스터에 우선 저장한다.

때때로 ALU는 결괏값뿐만아니라 연산 결과에 대한 추가적인 정보를 내보내야 할 때가 있다.

ex) 연산 결과가 음수일 때 `방금 계산한 결과는 음수이다` 라거나, 연산 결과가 레지스터보다 클 때 `결괏 값이 너무 크다(overflow)` 라거나..

이러한 연산 결과에 대한 추가적인 상태 정보를 `플래그`라고 부른다.

### 대표적인 플래그

- 부호 플래그: `연산한 결과의 부호`를 나타냄
  - 1일 경우 계산 결과가 음수, 0일 경우 양수
- 제로 플래그: `연산 결과 올림수나 빌림수가 발생했는지`를 나타냄
  - 1일 경우 연산 결과는 0, 0일 경우 0이 아님
- 캐리 플래그: `연산 결과가 0인지의 여부`를 나타냄
  - 1일 경우 올림수나 빌림수가 발생했음을 의미, 0일 경우 발생하지 않음
- 오버플로우 플래그: `오버플로우`를 나타냄
  - 1일 경우 오버플로우가 발생함. 0일 경우 발생하지 않았음
- 인터럽트 플래그: `인터럽트가 가능한지`를 나타냄
  - 1일 경우 인터럽트 가능, 0일 경우 인터럽트 붉능
- 슈퍼바이저 플래그: `현재 os의 cpu 모드(커널/사용자)`를 나타냄
  - 1일 경우 커널 모드, 0일 경우 사용자 모드

<br>

플래그들은 `래그 레지스터`라는 레지스터에 저장된다.

<br>

이 밖에도 ALU 내부에는 여러 계산을 위한 회로들이 있다.

대표적으로 덧셈의 위한 가산기, 뺄셈을 위한 보수기, 시프트 연산을 수행해주는 시프터, 오버플로우를 대비한 오버플로우 검출기 등이 있음

## 제어 장치

제어 장치는 CPU의 구성 요소 중 가장 정교하게 설계된 부품이라고 해도 과언이 아님. 그래서 제조사마다 제어 장치의 구현 방식이나 명령어를 해석하는 방식,

받아들이고 내보내는 정보에는 조금씩 차이가 있다. 여기서는 가장 대표적인 정보에만 초점을 맞춰 설명함

### 받아들이는 신호

1. `클럭 신호`

- `클럭`이란 컴퓨터의 모든 부품을 일사불란하게 움직일 수 있게 하는 시간 단위. 클럭의 '똑-딱 똑-딱' 주기에 맞춰 한 레지스터에서 다른 레지스터로 데이터가 이동되거나, ALU에서 연산이 수행되거나, CPU가 메모리에 저장된 명령어를 읽어 들임<br>
  BUT '컴퓨터의 모든 부품이 클럭 신호에 맞춰 작동한다.`라는 말을`컴퓨터의 모든 부품이 한 클럭마다 작동한다`라고 이해하면 안됨<br>
  컴퓨터 부품들은 클럭이라는 박자에 맞춰 작동할 뿐 한 박자마다 작동하는 것은 아니다.

2. `해석해야 할 명령어`

- CPU가 해석해야 할 명령어는 `명령어 레지스터`라는 특별한 레지스터에 저장된다. 제어 장치는 명령어 레지스터로부터 해석할 명령어를 받아들이고 해석한 뒤, 컴퓨터 부품들에 수행해야 할 내용을 알려줌

3. `플래그 레지스터 속 플래그 값`

- 플래그 값을 받아들이고 이를 참고하여 제어 신호를 발생시킨다.

4. `시스템 버스, 그 중에서 제어 버스로 전달된 제어 신호`

- 제어 신호는 CPU 뿐만 아니라 입출력 장치를 비롯한 CPU 외부 장치도 발생시킬 수 있다. 제어 장치는 제어 버스를 통해 외부로부터 전달된 제어 신호를 받아들인다.

<br>

### 내보내는 신호

크게 CPU 외부에 전달하는 제어 신호와 CPU 내부에 전달하는 제어 신호가 있다.

제어 장치가 CPU 외부에 제어 신호를 전달한다는 말은 곧 제어 버스로 제어 신호를 내보낸다는 말과 같다.

이러한 제어 신호에는 크게 메모리에 전달하는 제어 신호와 입출력 장치에 전달하는 제어 신호가 있다.

제어 장치가 메모리에 저장된 값을 읽거나 메모리에 새로운 값을 쓰고 싶다면 메모리로 제어 신호를 내보낸다. 그리고 제어 장치가 입출력 장치의 값을 읽거나 입출력 장치에 새로운 값을 쓰고 싶을 때는 입출력 장치로 제어 신호를 내보낸다.

제어 장치가 CPU 내부에 전달하는 제어신호에는 `ALU에 전달하는 제어 신호`와 `레지스터에 전달하는 제어 신호`가 있다.

ALU에는 수행할 연산을 지시하기 위해,

레지스터에는 레지스터 간에 데이터를 이동시키거나 레지스터에 저장된 명령어를 해석하기 위해 제어 신호를 내보낸다.